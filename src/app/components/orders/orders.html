<div class="page-container">
  <mat-card class="content-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>shopping_cart</mat-icon>
        Create New Order
      </mat-card-title>
      <mat-card-subtitle>Fill out the form below to create a new order</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="orderForm" (ngSubmit)="onSubmit()" class="data-form">
        
        <!-- Left Column -->
        <div class="form-column">
          <!-- Customer Information Section -->
          <div class="form-section">
            <h3 class="section-title">Customer Information</h3>
            <div class="form-grid">
              <mat-form-field appearance="outline" class="grid-item-full">
                <mat-label>Customer</mat-label>
                <mat-select formControlName="customer">
                  <mat-option *ngFor="let customer of customers" [value]="customer.id">
                    {{customer.name}}
                  </mat-option>
                </mat-select>
                <mat-error *ngIf="orderForm.get('customer')?.hasError('required')">
                  Customer is required
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="grid-item">
                <mat-label>Email</mat-label>
                <input matInput type="email" formControlName="customerEmail" placeholder="customer@example.com">
                <mat-icon matSuffix>email</mat-icon>
                <mat-error *ngIf="orderForm.get('customerEmail')?.hasError('required')">
                  Email is required
                </mat-error>
                <mat-error *ngIf="orderForm.get('customerEmail')?.hasError('email')">
                  Please enter a valid email
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="grid-item">
                <mat-label>Phone</mat-label>
                <input matInput type="tel" formControlName="customerPhone" placeholder="+1 (555) 123-4567">
                <mat-icon matSuffix>phone</mat-icon>
                <mat-error *ngIf="orderForm.get('customerPhone')?.hasError('required')">
                  Phone number is required
                </mat-error>
              </mat-form-field>
            </div>
          </div>

          <!-- Order Details Section -->
          <div class="form-section">
            <h3 class="section-title">Order Details</h3>
            <div class="form-grid">
              <mat-form-field appearance="outline" class="grid-item">
                <mat-label>Order Number</mat-label>
                <input matInput formControlName="orderNumber" placeholder="ORD-2024-001">
                <mat-icon matSuffix>tag</mat-icon>
                <mat-error *ngIf="orderForm.get('orderNumber')?.hasError('required')">
                  Order number is required
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="grid-item">
                <mat-label>Order Date</mat-label>
                <input matInput [matDatepicker]="orderDatePicker" formControlName="orderDate">
                <mat-datepicker-toggle matSuffix [for]="orderDatePicker"></mat-datepicker-toggle>
                <mat-datepicker #orderDatePicker></mat-datepicker>
              </mat-form-field>

              <mat-form-field appearance="outline" class="grid-item">
                <mat-label>Delivery Date</mat-label>
                <input matInput [matDatepicker]="deliveryDatePicker" formControlName="deliveryDate">
                <mat-datepicker-toggle matSuffix [for]="deliveryDatePicker"></mat-datepicker-toggle>
                <mat-datepicker #deliveryDatePicker></mat-datepicker>
              </mat-form-field>

              <mat-form-field appearance="outline" class="grid-item">
                <mat-label>Priority</mat-label>
                <mat-select formControlName="priority">
                  <mat-option *ngFor="let priority of priorities" [value]="priority">
                    {{priority}}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="outline" class="grid-item">
                <mat-label>Status</mat-label>
                <mat-select formControlName="status">
                  <mat-option *ngFor="let status of statuses" [value]="status">
                    {{status}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </div>
          </div>
        </div>

        <!-- Right Column -->
        <div class="form-column">
          <!-- Product Information Section -->
          <div class="form-section">
            <h3 class="section-title">Product Information</h3>
            <div class="form-grid">
              <mat-form-field appearance="outline" class="grid-item-full">
                <mat-label>Product</mat-label>
                <mat-select formControlName="product">
                  <mat-option *ngFor="let product of products" [value]="product.id">
                    {{product.name}} - ${{product.price}}
                  </mat-option>
                </mat-select>
                <mat-error *ngIf="orderForm.get('product')?.hasError('required')">
                  Product is required
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="grid-item">
                <mat-label>Quantity</mat-label>
                <input matInput type="number" formControlName="quantity" min="1">
                <mat-icon matSuffix>inventory</mat-icon>
                <mat-error *ngIf="orderForm.get('quantity')?.hasError('required')">
                  Quantity is required
                </mat-error>
                <mat-error *ngIf="orderForm.get('quantity')?.hasError('min')">
                  Quantity must be at least 1
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="grid-item">
                <mat-label>Unit Price</mat-label>
                <input matInput type="number" formControlName="unitPrice" min="0" step="0.01">
                <span matPrefix>$&nbsp;</span>
                <mat-error *ngIf="orderForm.get('unitPrice')?.hasError('required')">
                  Unit price is required
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="grid-item">
                <mat-label>Discount (%)</mat-label>
                <input matInput type="number" formControlName="discount" min="0" max="100">
                <span matSuffix>%</span>
              </mat-form-field>

              <div class="total-display">
                <div class="total-card">
                  <h4>Total Amount</h4>
                  <div class="total-amount">${{calculateTotal() | number:'1.2-2'}}</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Additional Options Expansion Panel -->
          <mat-expansion-panel class="options-expansion-panel">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <mat-icon>tune</mat-icon>
                Additional Options
              </mat-panel-title>
              <mat-panel-description>
                Configure order preferences and communication settings
              </mat-panel-description>
            </mat-expansion-panel-header>
            
            <!-- Checkboxes -->
            <div class="checkbox-group">
              <mat-checkbox formControlName="requiresApproval">
                Requires Management Approval
              </mat-checkbox>
              <mat-checkbox formControlName="rushOrder">
                Rush Order (Additional Fees Apply)
              </mat-checkbox>
              <mat-checkbox formControlName="giftWrap">
                Gift Wrap Service
              </mat-checkbox>
            </div>

            <!-- Radio Button Group -->
            <div class="radio-group">
              <label class="radio-group-label">Communication Preference:</label>
              <mat-radio-group formControlName="communicationPref" class="radio-group-content">
                <mat-radio-button value="email">Email Updates</mat-radio-button>
                <mat-radio-button value="sms">SMS Notifications</mat-radio-button>
                <mat-radio-button value="phone">Phone Calls</mat-radio-button>
                <mat-radio-button value="none">No Communications</mat-radio-button>
              </mat-radio-group>
            </div>

            <!-- Toggle Switches -->
            <div class="toggle-group">
              <mat-slide-toggle formControlName="newsletterSubscription">
                Subscribe to Newsletter
              </mat-slide-toggle>
            </div>
          </mat-expansion-panel>
        </div>

        <!-- Full Width Sections -->
        <div class="form-section-full">
          <!-- Shipping Information Expansion Panel -->
          <mat-expansion-panel class="shipping-expansion-panel">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <mat-icon>local_shipping</mat-icon>
                Shipping Information
              </mat-panel-title>
              <mat-panel-description>
                Configure delivery details and address
              </mat-panel-description>
            </mat-expansion-panel-header>

            <div class="shipping-grid">
              <mat-form-field appearance="outline" class="grid-item">
                <mat-label>Shipping Method</mat-label>
                <mat-select formControlName="shippingMethod">
                  <mat-option *ngFor="let method of shippingMethods" [value]="method">
                    {{method}}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="outline" class="shipping-address">
                <mat-label>Shipping Address</mat-label>
                <textarea matInput formControlName="shippingAddress" rows="1" placeholder="Enter complete address"></textarea>
                <mat-icon matSuffix>location_on</mat-icon>
                <mat-error *ngIf="orderForm.get('shippingAddress')?.hasError('required')">
                  Shipping address is required
                </mat-error>
              </mat-form-field>

              <div class="shipping-details">
                <mat-form-field appearance="outline">
                  <mat-label>City</mat-label>
                  <input matInput formControlName="shippingCity">
                  <mat-error *ngIf="orderForm.get('shippingCity')?.hasError('required')">
                    City is required
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline">
                  <mat-label>ZIP Code</mat-label>
                  <input matInput formControlName="shippingZip">
                  <mat-error *ngIf="orderForm.get('shippingZip')?.hasError('required')">
                    ZIP code is required
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline">
                  <mat-label>Country</mat-label>
                  <input matInput formControlName="shippingCountry">
                  <mat-error *ngIf="orderForm.get('shippingCountry')?.hasError('required')">
                    Country is required
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
          </mat-expansion-panel>
        </div>

        <div class="form-section-full">
          <!-- Special Instructions & Terms Expansion Panel -->
          <mat-expansion-panel class="terms-expansion-panel">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <mat-icon>assignment</mat-icon>
                Special Instructions & Terms
              </mat-panel-title>
              <mat-panel-description>
                Additional notes and agreement terms
              </mat-panel-description>
            </mat-expansion-panel-header>

            <!-- Special Instructions -->
            <mat-form-field appearance="outline" class="grid-item-full">
              <mat-label>Special Instructions</mat-label>
              <textarea matInput formControlName="specialInstructions" rows="2" 
                       placeholder="Any special handling instructions or notes..."></textarea>
              <mat-icon matSuffix>note</mat-icon>
            </mat-form-field>

            <!-- Terms and Conditions -->
            <div class="terms-section">
              <mat-checkbox formControlName="termsAccepted">
                I agree to the <a href="#" target="_blank">Terms and Conditions</a>
              </mat-checkbox>
              <mat-error *ngIf="orderForm.get('termsAccepted')?.hasError('required') && orderForm.get('termsAccepted')?.touched">
                You must accept the terms and conditions
              </mat-error>
            </div>
          </mat-expansion-panel>
        </div>

        <!-- Form Actions -->
        <mat-card-actions class="form-actions">
          <button mat-raised-button color="primary" type="submit" [disabled]="orderForm.invalid">
            <mat-icon>save</mat-icon>
            Create Order
          </button>
          <button mat-stroked-button type="button" (click)="onReset()">
            <mat-icon>refresh</mat-icon>
            Reset Form
          </button>
          <button mat-button type="button">
            <mat-icon>preview</mat-icon>
            Preview
          </button>
        </mat-card-actions>
      </form>
    </mat-card-content>
  </mat-card>
</div>
