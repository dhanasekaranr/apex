<div class="sidenav-header" [class.collapsed]="isCollapsed()">
  <!-- Bank of America Logo -->
  @if (!isCollapsed()) {
    <div class="bofa-logo-section">
      <img 
        src="https://secure.bankofamerica.com/content/images/ContextualSiteGraphics/Logos/en_US/BofA_rgb.png" 
        alt="Bank of America" 
        class="bofa-logo">
    </div>
  }
  
  <!-- User Profile Section - Watson Joyce -->
  <div class="profile-section" [class.collapsed]="isCollapsed()">
    <div class="profile-avatar">
      <mat-icon class="avatar-icon">person</mat-icon>
    </div>
    @if (!isCollapsed()) {
      <div class="profile-info">
        <div class="profile-name">Watson Joyce</div>
        <div class="profile-role">Administrator</div>
      </div>
    }
  </div>
</div>

<mat-divider></mat-divider>

<div class="nav-list" [class.collapsed]="isCollapsed()">
    <!-- Dynamic navigation items -->
    @for (item of navItems(); track item.id || item.label) {
      
      <!-- Regular navigation item -->
      @if (isRegularItem(item)) {
        <a 
          [routerLink]="item.disabled ? null : item.routerLink"
          [routerLinkActive]="item.disabled ? '' : 'active-link'"
          [class.nav-item]="true"
          [class.collapsed]="isCollapsed()"
          [class.disabled]="item.disabled"
          [matTooltip]="isCollapsed() ? item.label : ''"
          matTooltipPosition="right">
          <mat-icon>{{ item.icon }}</mat-icon>
          @if (!isCollapsed()) {
            <span>{{ item.label }}</span>
          }
          @if (item.disabled && item.disabledReason && !isCollapsed()) {
            <mat-icon 
              class="info-icon"
              [matTooltip]="item.disabledReason"
              matTooltipPosition="right">
              info
            </mat-icon>
          }
        </a>
      }

      <!-- Expandable navigation item with submenu -->
      @if (isExpandable(item) && !isCollapsed()) {
        <div class="expandable-item">
      
          <!-- Expandable header -->
          <button 
            type="button"
            class="nav-item expandable-header"
            (click)="toggleExpanded(item, $event)"
            [attr.aria-expanded]="item.expanded"
            [attr.aria-label]="'Toggle ' + item.label + ' submenu'"
            [class.disabled]="item.disabled"
            [disabled]="item.disabled">
            <mat-icon>{{ item.icon }}</mat-icon>
            <span>{{ item.label }}</span>
            <mat-icon class="expand-icon" [class.expanded]="item.expanded">
              {{ item.expanded ? 'expand_less' : 'expand_more' }}
            </mat-icon>
            @if (item.disabled && item.disabledReason) {
              <mat-icon 
                class="info-icon"
                [matTooltip]="item.disabledReason"
                matTooltipPosition="right">
                info
              </mat-icon>
            }
          </button>
          
          <!-- Submenu items -->
          <div class="submenu" 
               [class.expanded]="item.expanded"
               [attr.aria-hidden]="!item.expanded">
            @for (subItem of item.children; track subItem.id || subItem.label) {
              <a 
                [routerLink]="subItem.disabled ? null : subItem.routerLink"
                [routerLinkActive]="!subItem.disabled ? 'active-link' : ''"
                [class.disabled]="subItem.disabled"
                [attr.aria-label]="subItem.label"
                [attr.tabindex]="!item.expanded ? -1 : 0"
                class="nav-item sub-item">
                <mat-icon class="sub-icon">{{ subItem.icon }}</mat-icon>
                <span>{{ subItem.label }}</span>
                @if (subItem.disabled && subItem.disabledReason) {
                  <mat-icon 
                    class="info-icon"
                    [matTooltip]="subItem.disabledReason"
                    matTooltipPosition="right">
                    info
                  </mat-icon>
                }
              </a>
            }
          </div>
        </div>
      }
    }
</div>

<div class="sidenav-footer">
    <div>
      <!-- Dynamic footer items -->
      @for (footerItem of footerItems(); track footerItem.id || footerItem.label) {
        
        <!-- Regular footer item -->
        @if (isRegularItem(footerItem)) {
          <a 
            [routerLink]="footerItem.disabled ? null : footerItem.routerLink"
            [class.nav-item]="true"
            [class.disabled]="footerItem.disabled">
            <mat-icon>{{ footerItem.icon }}</mat-icon>
            <span>{{ footerItem.label }}</span>
            @if (footerItem.disabled && footerItem.disabledReason) {
              <mat-icon 
                class="info-icon"
                [matTooltip]="footerItem.disabledReason"
                matTooltipPosition="right">
                info
              </mat-icon>
            }
          </a>
        }

        <!-- Expandable footer item with submenu -->
        @if (isExpandable(footerItem)) {
          <div class="expandable-item">
        
            <!-- Main expandable item -->
            <div 
              class="nav-item expandable-header"
              [class.expanded]="footerItem.expanded"
              [class.disabled]="footerItem.disabled"
              (click)="toggleExpanded(footerItem, $event)">
              <mat-icon>{{ footerItem.icon }}</mat-icon>
              <span>{{ footerItem.label }}</span>
              @if (footerItem.disabled && footerItem.disabledReason) {
                <mat-icon 
                  class="info-icon"
                  [matTooltip]="footerItem.disabledReason"
                  matTooltipPosition="right">
                  info
                </mat-icon>
              }
              <mat-icon class="expand-icon">
                {{ footerItem.expanded ? 'expand_less' : 'expand_more' }}
              </mat-icon>
            </div>

            <!-- Submenu items -->
            <div 
              class="submenu" 
              [class.expanded]="footerItem.expanded">
              @for (child of footerItem.children; track child.id || child.label) {
                <a 
                  [routerLink]="child.disabled ? null : child.routerLink"
                  [routerLinkActive]="child.disabled ? '' : 'active-link'"
                  [class.nav-item]="true"
                  [class.submenu-item]="true"
                  [class.disabled]="child.disabled">
                  <mat-icon>{{ child.icon }}</mat-icon>
                  <span>{{ child.label }}</span>
                  @if (child.disabled && child.disabledReason) {
                    <mat-icon 
                      class="info-icon"
                      [matTooltip]="child.disabledReason"
                      matTooltipPosition="right">
                      info
                    </mat-icon>
                  }
                </a>
              }
            </div>
          </div>
        }
      }
    </div>
  
  <!-- Toggle Button at Bottom Right -->
  <button 
    mat-icon-button 
    class="collapse-toggle-bottom"
    (click)="toggleCollapse()"
    [attr.aria-label]="isCollapsed() ? 'Expand sidebar' : 'Collapse sidebar'"
    [matTooltip]="isCollapsed() ? 'Expand sidebar' : 'Collapse sidebar'"
    matTooltipPosition="right">
    <mat-icon>{{ isCollapsed() ? 'chevron_right' : 'chevron_left' }}</mat-icon>
  </button>
</div>
